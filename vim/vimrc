source ~/dotfiles/vim/bundles.vim

inoremap jk <Esc>

set background=dark
silent! colorscheme solarized

" Uncomment line below to autostrip trailing whitespace on buffer write 
autocmd FileType c,cpp,java,make,perl autocmd BufWritePre <buffer> :%s/\s\+$//e

" Automatically open quickfix window after any grep
autocmd QuickFixCmdPost *grep* cwindow

" Don't swamp buffer list with fugitive buffers
autocmd BufReadPost fugitive://* set bufhidden=delete

set hidden
set cursorline
set number
set nobackup
set noswapfile

" Map leader
let mapleader = "\<Space>"

" Shortcut to rapidly toggle `set list`
nnoremap <leader>l :set list!<CR>

function! SetPathAndTags()
  if &filetype ==# 'netrw'
    let currdir = b:netrw_curdir
  else
    let currdir = expand('%:p:h')
  endif
  execute 'cd' currdir
  !ctags -R --c-kinds=+p
  cd -
  let &path=&path.",".currdir."/**"
  let &tags=&tags.",".currdir."/tags"
endfunction

" Add current files directory to path and tags
nnoremap <leader>t :call SetPathAndTags()<CR>

" Ag mappings
nnoremap <leader>a :Ag! --ignore tags <C-R>=expand("<cword>")<CR> <C-R>=expand("%:p:h")<CR>

" Ggrep mapping
nnoremap <leader>g :Ggrep <C-R>=expand("<cword>")<CR>

" Toggle Gundo
nnoremap <leader>u :GundoToggle<CR>

" Pick mappings
nnoremap <Leader>p :call PickFile()<CR>
nnoremap <Leader>s :call PickFileSplit()<CR>
nnoremap <Leader>v :call PickFileVerticalSplit()<CR>
nnoremap <Leader>b :call PickBuffer()<CR>
nnoremap <Leader>] :call PickTag()<CR>

" Load project specific vim configuration (vim must start from .vim.custom folder)
if filereadable(".vim.custom")
  so .vim.custom
endif

